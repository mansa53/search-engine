{"url": "https://www.reddit.com/r/learnprogramming/comments/9c6gdh/problem_rewriting_pdf_files_automatically_but/", "text": "Hello guys! \nThere is a problem that I'm trying to solve for the past few weeks:\nWe got 2 PDF files, with editable fields. Both of them identical, but one is the correct template (correct metadata coded into the file), other one is not, but all the fields are populated. The task is to rewrite the completed one to the correct template. \n\nThe closest solution that I found is to do that with VBA, copy each field into the Excel somehow, then to populate the fields using this method: https://youtu.be/uU55FCbPHCI\nBut it takes a lot of time, every field takes a second to populate, and let's say we have a lot of files, that will take hours. The another problem is that the PDF has some customizable forms, like week plan: first click on the + button to add the day, then click + button to add an activity for each hour (only then we can populate the field). \n\nI'm doing good with VBA, and learning Python, I discovered lately that some of the libraries could help (like pyPDF2 or PDF miner) but they seems complicated and I have no idea if the result would be satisfying. What programming language would you recommend to archive that? What methods? \nThank you so much for getting that far :) couldn't find the similar answer anywhere.\n-mick \n\n", "score": 0, "comments": [{"body": "Before I start talking about how to fill out a PDF in `pyPDF2`, I'd like to make sure that you have a good method of **getting** the text. If you run `pdftotext`, included in the [`poppler`](https://poppler.freedesktop.org/) suite, do you get anything usable from the PDF with the correct info?", "id": "e59166t", "replies": [{"body": "Hey POGtastic, I will definitely try that, looks promising. I was focusing on the filling methods, cause it looks like there is a lot of getting methods (I hope that one of them will work), and Im not quite sure what kind of data do I need", "id": "e596vfg", "replies": [{"body": "The primary filling method I'm looking at is described [here](https://bostata.com/post/how_to_populate_fillable_pdfs_with_python/).\n\nIn short, I would suggest the following:\n\n1. Replace all of the fields of the template with **tags** - a unique identifier that the Python program can find. For example, I'd have things like `NAME_TAG`, `DATE_TAG`, `AMOUNT_TAG`, etc. The below program will search for a text field with `NAME_TAG` with the actual name, and so on.\n\n2. Create a program that will take the above template and a dictionary of values that associate `NAME_TAG` with \"Bob Smith,\" \"AMOUNT_TAG\" with 10.99, and so on. It will then save an output file with all of the replaced values.\n\n3. Create a program that will take the values from the other PDF and create the dictionary for use in the above. This could either be the easiest or hardest part, depending on how shitty the PDF is.\n\nLet me know if you need any help with any of these steps.", "id": "e5979p3", "replies": [{"body": "Thank you, \nI saw that solution before, and there is one thing that bothers me: in my case, each document (template) has the same form, but different metadata that I cannot change, to be able to use it later. \nUsing the method described above, I'd have to work on 3 files: populated PDF (source), PDF template with tags added, and the final PDF (output), to be able to use the method again in the future, changing only the source and output files patch? Do I understand it right? ", "id": "e599bkf", "replies": [{"body": "You'd end up having the following:\n\n* A single template PDF with the correct format, which contains the `TAG`s in each fillable field.\n\n* A big directory of source PDFs with the correct data but the wrong format, which you probably want to do in a big bulk operation.\n\n* The Python program.\n\nThe goal is that you'd do something like\n\n    python format_converter.py ~/SourceDir/ ~/ResultDir\n\nand it would grab all of the PDFs from `SourceDir` and use the template to save correctly formatted PDFs to `ResultDir`.", "id": "e599g96", "replies": [{"body": "Thank you  so much POGtastic, I'll try to do that this week :))", "id": "e59bc3o", "replies": []}]}]}]}]}]}], "title": "[problem] rewriting PDF files automatically, but..."}