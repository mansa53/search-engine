{"url": "https://www.reddit.com/r/learnprogramming/comments/9cl0nm/still_getting_premature_end_of_script_headers/", "text": "I've created a script that searches for specific sports streams base on the users input. I've tested the code in terminal via SSH and it works well. However, when putting it together to be viewed on a browser, I get a **500 server error.** When checking the error log file, it says \"premature end of script headers\". I have dealt with this in the past, but it mostly had to do with some faulty html code.\n\nI need some fresh eyes on this as I'm worn out for the day.\n\n\u200b\n\nThinks I've tried already:\n\n\u200b\n\n* 1.) Deleted file and created a new one with the same code. (wasn't sure if the file was corrupted).\n* 2.) The file has 755 permissions\n* 3.) created the script using TEXT EDIT in MacOS using PLAIN TEXT. (which my scripts have worked before using this method.)\n* 4.) I also added the: `\"Content-type: text/html\\n\\n\"`\n\nHere is my code:\n\n\u200b\n\n    #!/home/mydomain/python/Python-2.7.2/python \n    \n    import json\n    import requests\n    import re\n    import cgi\n    \n    \n    print \"Content-type: text/html\\n\\n\"\n    \n    \n    print ('<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">')\n    print ('<HEAD><TITLE>Search for live sports streams</TITLE></HEAD>')\n    print ('<center>')\n    print ('<a href=\"http://www.mydomain.com/cgi-bin/stream.py\"><img src=\"http://www.mydomain.com/image/wlogo.png\"></a>')\n    print ('<p />')\n    print ('<a href=\"http://www.mydomain.com/cgi-bin/wa/nhl.py\"><img src=\"http://www.mydomain.com/image/nhl.png\" align=\"center\"></a></br>')\n    \n    print \"\"\"<style> \n    a.hi {\n      display: inline-block;\n      background: rgba(238, 3, 210, 0.1);\n    } \n    \n    a.hi {\n      font-size: 13px;\n      text-align: left;\n      padding: 1px;\n      margin: 1px;\n    }\n    \n    \n    div.jsrt {\n      color: white;\n      \n    } \n    </style>\"\"\"\n    print ('<body style=\"background-color: black; color: white;\" vlink=\"#125475\"; link=\"#5ba0c1\">')\n    print ('<p />')\n    print ('<div style=\"display: inline-block; text-align: left;\">')\n    \n    form = cgi.FieldStorage()\n    searchterm = form.getvalue('searchbox')\n    endusers = (searchterm.replace(\" \",\"+\"))\n    \n    try:\n    \n        r = requests.get('https://www.otherdomain.com/sub/streams/.json', headers = {'User-agent': 'Chrome'})\n        theJSON = json.loads(r.text)  \n    \n        for element in theJSON['data']['children']:\n            if endusers in element['data']['url']:\n                linkone = element['data']['url']\n                break\n            else:\n                continue\n    \n        linktwo = '.json'\n        url = \"\".join((linkone, linktwo,))\n    \n        r = requests.get(url, headers = {'User-agent': 'Chrome'})\n        theJSON = json.loads(r.text)\n    \n        output = [theJSON[1]['data']['children']]\n    \n        for child in output:\n            for post in child:\n                text = post['data']['body'].strip(' \\t\\n\\r').replace(')', ' ').replace('(', ' ')\n                text = str(re.findall('(\\S+://+\\S*)',text))\n                text = text.replace('[', ' ').replace(']', ' ').replace(\"'\", ' ').strip()\n                if text != '':\n                    text = text.split(',')\n                    for t in text:\n                        t = t.strip(' \\t\\n\\r')\n                        t = t.replace(\"u \", \"\")\n                        print \"\"\"<a class=\"hi\" href=\"{t}\">{t}</a><br>\"\"\".format(t=t)\n    \n    except:\n        print ('<br /> Sorry, there are no links available.<br />')\n    \n    \n    print ('</center>')\n    print ('</div>')\n    \n    print ('<script src=\"http://www.mydomain.com/ovc/counter.js\"></script>')\n    print ('</body>')\n\nThank you!", "score": 1, "comments": [{"body": "    print ('<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">')\n    print ('<HEAD><TITLE>Search for live sports streams</TITLE></HEAD>')\n    print ('<center>')\n\nWhere's the opening <HTML> tag?  Where's the opening <BODY> tag?", "id": "e5be06c", "replies": [{"body": ">print ('<body style=\"background-color: black; color: white;\" vlink=\"#125475\"; link=\"#5ba0c1\">')\n\nIt's been there. :)\n\n&#x200B;\n\nalso, I never needed a html tag. The scripts have always worked without it via browser.", "id": "e5bgj1p", "replies": [{"body": "The <BODY> tag needs to come immediately after the close of the <HEAD> tag.  You've got a bunch of stuff in between, which isn't valid.", "id": "e5biglj", "replies": []}]}]}, {"body": "So the second hit on this error suggests it can be that your apache/other webserver may be missing config like:\n\n    AddHandler php5-script .php\n\nbasically if you don't tell it to run python, it will read your file verbatim. it will find plaintext instead of headers, specifically:\n\n    #!/home/mydomain/python/Python-2.7.2/python \n\n(note there's also 2 newlines here so it would assume header section is over)\n\n\nSo the first thing to check is, are you correctly executing python. try it with a helloworld.py (or whatever extension you want to use) that just prints hello world. \n\nedit: also obviously this is a php handler, you'll need a python one. I copied pasted this from the link I googled (2nd result on the error message you posted). Second after-post thought: open and close your html tags, bad habits will be hard to break once formed. ", "id": "e5bhw2f", "replies": []}], "title": "Still getting \"premature end of script headers\" error. I've already tried all options regarding this error. Need fresh eyes on script."}