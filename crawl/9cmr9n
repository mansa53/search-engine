{"url": "https://www.reddit.com/r/learnprogramming/comments/9cmr9n/batch_variables_cant_work_with_powershell/", "text": "I'm working on a simple program to download hundreds of one page PDFs from a link. It starts at the variable 0000 and goes 0001, 0002, and so forth. How do I get it that way?\nHere's my code so far:\n\n    @echo off\n    cls\n    set /a var=000\n    :1\n    PowerShell -Command \"cd C:\\Users\\MyUsername\\Desktop\\HRW; Invoke-WebRequest -OutFile %var%.pdf website.com/%var%.pdf\"\n    set /a var=%var%+1\n    goto 1\n\nFor some reason powershell outputs this:\n\n    Invoke-WebRequest : AccessDeniedAccess Denied\n    At line:1 char:37\n    + cd C:\\Users\\8bit_coder\\Desktop\\HRW; Invoke-WebRequest -OutFile 0.pdf\n    https://my. ...\n\nAnyone know how to fix this? I've been scrounging online for the past hour and I haven't found a solution. \n", "score": 1, "comments": [{"body": "who not just use powershell?\n\nThe number formatting gets a bit convoluted but this should work\n\n    cd C:\\Users\\MyUsername\\Desktop\\HRW; \n    1..100 | foreach {Invoke-WebRequest -OutFile $(\"{0:000}.pdf\" -f $_) $(\"website.com/{0:000}.pdf\" -f $_)}", "id": "e5bs8r7", "replies": [{"body": "I tried it with the website link I have and powershell spat this out:\n\n    Invoke-WebRequest : AccessDeniedAccess \n    DeniedDD75BE1D7FCF998BNWKQyE8Q8glPxEZckJRtBgf4L/r+i3CccK4RX/2zbx9th5SngWA+hPSfPiQgkd5Qpuc/WHvs7/U=\n    At C:\\Users\\MyUsername\\Desktop\\HRW\\download.ps1:2 char:19\n    + 1..100 | foreach {Invoke-WebRequest -OutFile $(\"{0:000}.pdf\" -f $_) $(\"https://m ...\n    + ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n        + CategoryInfo          : InvalidOperation: (System.Net.HttpWebRequest:HttpWebRequest) [Invoke-WebRequest], WebException\n        + FullyQualifiedErrorId : WebCmdletWebResponseException,Microsoft.PowerShell.Commands.InvokeWebRequestCommand\n\nAlso I need to make sure that the numbers are like 0000, 0001, 0002 etc not 0, 1, 2 etc. \n\nWhat's strange is that using it with a single link:\n\n    Invoke_WebRequest -OutFile 0000.pdf https://website.com/somelink_0000.pdf\n\nworks completely fine but when we get variables into play it just doesn't work.\n\nMaybe what it's doing is trying to download `website.com/somelink_0.pdf`instead of `website.com/somelink_0000.pdf` because the files are stored like `0000.pdf` instead of `0.pdf`", "id": "e5by49j", "replies": [{"body": "I think your original is indeed doing that. My code should format the numbers but I put one less 0 than you need, try this.\n\n    1..100 | foreach {Invoke-WebRequest -OutFile $(\"{0:0000}.pdf\" -f $_) $(\"website.com/{0:0000}.pdf\" -f $_)}", "id": "e5byu0l", "replies": []}]}]}], "title": "Batch variables can't work with Powershell"}