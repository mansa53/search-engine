{"url": "https://www.reddit.com/r/learnprogramming/comments/9btq50/error_invalidoperationexception_was_unhandled_by/", "text": " \n\nGetting the Error:InvalidOperationException was unhandled by user code when trying to make a call to my web service. I'm trying to serialize a class object that I get through my web service and return it back as an XML String but run into the error. I already changed the object's fields from private to public but that doesn't seem to be the issue. This is the error that's thrown but when I end the session I also get the Error:The remote server returned an error: 500 internal server error and highlights:\n\n    Dim respond As HttpWebResponse = CType(request.GetResponse, HttpWebResponse)\n\nNot sure why this happens either when I look it up. Suggestions?\n\n**My Web Service**\n\n    <Route(\"Contents/{ordNbr}\")>\n    <HttpGet>\n    Public Function GetOrderContents(ByVal ordNbr As String) As String\n         \n         Dim retValue As ReturnVal\n         retValue = GetOrderInformation(ordNbr)\n         Dim sp = New Sharepoint()\n         Dim t = sp.GetOrderContent(retValue.Year, retValue.SONumber)\n         Dim contentFolder = New SPFolderOver()\n    \n         contentFolder = SPFolderOver.LoadFolder(t)\n         contentFolder.FolderName = t.FullPath\n         \n        Dim result = String.Empty\n         Dim serializer As XmlSerializer = New XmlSerializer(contentFolder.[GetType]())\n    \n         Using writer As StringWriter = New StringWriter()\n             serializer.Serialize(writer, contentFolder)\n             Return result = writer.ToString()\n         End Using\n     End Function\n\n**My Form Call to the Service**\n\n    Public Sub SubmitOrder_Click(sender As Object, e As EventArgs) Handles SubmitOrder.Click\n        \n         Dim orderString As String = orderNumber.Text\n         If orderString = \"\" Then\n             MsgBox(\"Please Enter in Order Number\")\n             Exit Sub\n         End If\n    \n         Dim apiUrl = \"http://localhost:54754/orders/Contents/\" + orderString\n    \n         Dim request As HttpWebRequest\n         request = CType(WebRequest.Create(apiUrl), HttpWebRequest)\n         request.Method = \"GET\"\n         request.ContentType = \"text/xml\"\n    \n         Dim respond As HttpWebResponse = CType(request.GetResponse, HttpWebResponse)\n         Dim myResponse = String.Empty\n    \n         Using sr As StreamReader = New StreamReader(respond.GetResponseStream())\n             myResponse = sr.ReadToEnd()\n         End Using\n    \n          Response.Write(myResponse)\n      End Sub", "score": 1, "comments": [], "title": "ERROR: InvalidOperationException was unhandled by user code when Serializing a Class Object to XML String"}