{"url": "https://www.reddit.com/r/learnprogramming/comments/9c282f/web_scraping_with_scrapy_hidden_css/", "text": "Hi all,\n\nI'm trying to pull some info from a website with scrapy. In experimenting with the CSS selectors, I seem to find that scrapy doesn't include the child nodes of divs with the 'display: none' attribute (blue) when returning results (through the response.css(\"stuff\").extract() method.)\n\nHowever, on the current page, the CSS indicated in red doesn't have the 'display: none' attribute, and none of its child nodes can be returned either. Is there a method to bypass this, or is this not the root of the problem at all?\n\nMany thanks!\n\nedit: appended the post with a screenshot of aforementioned css code", "score": 0, "comments": [{"body": "https://imgur.com/XJAQQ8N", "id": "e57fge6", "replies": []}, {"body": "works fine, maybe your selector expression is wrong.", "id": "e57q291", "replies": [{"body": "Not sure what you mean by that? What I did is:\n1. I opened Anaconda prompt and ran:\n2. scrapy shell\n3. fetch(\"url\")\n4. response.css(\"#aisle_42-box\").extract()\nand 4 returned nothing\n\nmy selector expression doesn't seem to return any of the aisle numbers listed in the screenshot even though I use # specifically to indicate it's an id.\n\nI'll post the url for you guys to try:\nhttps://www.wellcome.com.hk/wd2shop/en/mobile/html/shop/chilled-and-frozen-food.html#/hs_srch_page_no=1&hs_dept_id=31\n", "id": "e57tggg", "replies": [{"body": "if you literally put\n\n`fetch(\"url\")`\n\nthat won't work as \"url\" is not a valid URL.\n\nWhat I mean is, I can locally use the css selectors and see elements which have style display: none\n\n\u200b\n\nEdit: Also if I follow the link you gave above, [https://www.wellcome.com.hk/wd2shop/en/mobile/html/shop/chilled-and-frozen-food.html#/hs\\_srch\\_page\\_no=1&hs\\_dept\\_id=31](https://www.wellcome.com.hk/wd2shop/en/mobile/html/shop/chilled-and-frozen-food.html#/hs_srch_page_no=1&hs_dept_id=31) No elements on that page have an id of \"aisle\\_42-box\"", "id": "e57u915", "replies": [{"body": "my bad i meant to say fetch(\"https://www.wellcome.com.hk/wd2shop/en/mobile/html/shop/chilled-and-frozen-food.html#/hs_srch_page_no=1&hs_dept_id=31\")\n\nI forgot to put in the url.\n\n\nCan you show me exactly which css selectors you used that show all elements with style display: none? I keep getting syntax errors.", "id": "e57up1k", "replies": [{"body": "OK, the problem is that content is loaded in with ajax, if you view the source of the page aisle\\_42 doesn't exist anywhere.\n\nYet if you inspect the DOM then it does exist, the element is added by javascript.\n\nthere are 9 xhr (xml http / ajax requests) made by the page, the content you want is probably in one of the following two\n\n[https://www.wellcome.com.hk/wd2shop/docroot/en/das.xml](https://www.wellcome.com.hk/wd2shop/docroot/en/das.xml) and\n\n[https://www.wellcome.com.hk/wd2shop/docroot/en/district\\_cnc.xml](https://www.wellcome.com.hk/wd2shop/docroot/en/district_cnc.xml)\n\nif not open the developer console in your browser, switch to the network tab, reload the page and sort by \"cause\" looking for the xhr (ajax) requests", "id": "e57v9jg", "replies": [{"body": "\n\nFirst of all, thank you; this is exactly what I needed!\n\nI'm really new to this web scraping stuff. Am I correct in understanding that because ajax is involved, I can click on something on the page in a browser to make content change, like the left hand navigation bar appear?\n\nAlso how does one open the DOM? I couldn't find it after using inspect element -> sources (I only found a folder called docroot/en/images/banner)\n\nAnd finally how did you identify the XML http requests within the html/css layout?\n\nAnyway, thanks so much for answering!", "id": "e57wo5r", "replies": [{"body": "Inspect element should open the developer tools which should show the current state of the DOM.\n\nI found the XHR requests in the network tab of the developer tools.", "id": "e57x4ak", "replies": []}]}]}]}]}]}]}], "title": "Web Scraping with scrapy: hidden CSS?"}