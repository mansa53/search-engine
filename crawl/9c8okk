{"url": "https://www.reddit.com/r/learnprogramming/comments/9c8okk/why_is_this_returning_an_empty_list/", "text": "Hey there! I'm developing a piece of software that will return the title and price of a user chosen game from Amazon. It was working great, but now suddenly the program returns an empty list when parsing the hrefs on the Bing page looking for Amazon.\n\nTo make sure I wasn't crazy I wrote a quick script to do this same thing but with pre set parameters for testing purposes and it works pefectly. I'll include the link to the problem script and I'll also post the working script down below.\n\n[problem script] (https://github.com/MaxBranvall/gameScraper/blob/bug04/webScraper.py) \n\nLine 64 is where the link is grabbed, line 68 is where the error gets raised, and line 76 is where I handle the error. I just print the response object (which is a 200 btw) and a quick error message to keep the program from crashing.\n\nKeep in mind I've only been coding under a year so I'm sure my code can be greatly improved, I'm just looking to see if I'm overlooking anything thats breaking my program here.\n\nHere's the test code that works with no issues\n\n    import requests\n    from lxml import html\n    \n    header = { \n        'USER-AGENT': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.99 Safari/537.36',\n    }\n    \n    bingPage = requests.get('https://www.bing.com/search?q=gta+v+xbox+one')\n    bingPageContent = html.fromstring(bingPage.content)\n    \n    link1 = bingPageContent.xpath('//*[@id=\"b_results\"]/li[1]/h2/a/@href')\n    \n    amazonPage = link1[0]\n    \n    getAPage = requests.get(amazonPage, headers= header)\n    \n    print(amazonPage)\n    print(getAPage)\n    # print(bingPageContent.text())\n    \n    amazonPage1 = requests.get(amazonPage, headers= header)\n    amazonContent = html.fromstring(amazonPage1.content)\n    \n    price = amazonContent.xpath('//*[@id=\"priceblock_ourprice\"]/span[2]/text()')\n    \n    print(price)\n\nThanks in advance!", "score": 1, "comments": [{"body": "It's your header on the bing request.\n\nAccording to [bing api docs](https://docs.microsoft.com/en-us/rest/api/cognitiveservices/bing-web-api-v7-reference#headers) it requires a key.\n\n>Ocp-Apim-Subscription-Key  \n>  \n>Required request header.  \n>  \n>The subscription key that you received when you signed up for this service in [Cognitive Services](https://www.microsoft.com/cognitive-services/).\n\nBut if you remove the header from the request it works for some reason.\n\n\u200b", "id": "e590qel", "replies": [{"body": "Hm strange. The thing that throws me off is I\u2019ve been developing this for about a month and have made a ton of test searches and I went to work on it yesterday and boom, didn\u2019t work.\n\nAlso in the test script it works even with a header, I\u2019ll try it when I get home though. Thank you!", "id": "e59fmma", "replies": []}, {"body": "Well removing the header worked like a charm. Very weird lol. Thanks again!", "id": "e5adv70", "replies": []}]}], "title": "Why is this returning an empty list?"}